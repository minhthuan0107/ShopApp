<div class="comment-table-container">
  <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800 title-shift-up"> üí¨ Danh s√°ch b√¨nh lu·∫≠n </h1>
  </div>
  <!-- T√¨m ki·∫øm -->
  <div class="search-wrapper mb-3">
    <mat-form-field appearance="outline" class="w-100">
      <mat-label>T√¨m ki·∫øm b√¨nh lu·∫≠n</mat-label>
      <input matInput [(ngModel)]="keyword" placeholder="Nh·∫≠p h·ªç t√™n..." (keyup)="applyFilter()">
      <button mat-icon-button matSuffix disabled>
        <mat-icon>search</mat-icon>
      </button>
    </mat-form-field>
  </div>
  <table mat-table [dataSource]="dataSource" class="mat-elevation-z2 custom-comment-table">
    <!-- ID -->
    <ng-container matColumnDef="comment_id">
      <th mat-header-cell *matHeaderCellDef>ID</th>
      <td mat-cell *matCellDef="let row">{{ row.comment_id }}</td>
    </ng-container>
    <!-- Ng∆∞·ªùi d√πng -->
    <ng-container matColumnDef="user_name">
      <th mat-header-cell *matHeaderCellDef>Ng∆∞·ªùi d√πng</th>
      <td mat-cell *matCellDef="let row">{{ row.user_name }}</td>
    </ng-container>

    <!-- N·ªôi dung -->
    <ng-container matColumnDef="content">
      <th mat-header-cell *matHeaderCellDef>B√¨nh lu·∫≠n</th>
      <td mat-cell *matCellDef="let row">
        {{ row.content }}
        <ng-container *ngIf="row.replies && row.replies.length > 0">
          <button mat-button color="primary" (click)="toggleReplies(row)">
            {{ isExpanded(row) ? '·∫®n ph·∫£n h·ªìi' : 'Xem ph·∫£n h·ªìi' }} ({{ row.replies.length }})
          </button>
        </ng-container>
      </td>
    </ng-container>

    <!-- Ng√†y b√¨nh lu·∫≠n -->
    <ng-container matColumnDef="createAt">
      <th mat-header-cell *matHeaderCellDef>Ng√†y</th>
      <td mat-cell *matCellDef="let row">
        {{ row.createAt | date: 'dd-MM-yyyy HH:mm' }}
      </td>
    </ng-container>

    <!-- H√†nh ƒë·ªông -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>H√†nh ƒë·ªông</th>
      <td mat-cell *matCellDef="let row">
        <button mat-icon-button matTooltip="X√≥a" (click)="deleteComment(row.comment_id)">
          <mat-icon color="warn">delete</mat-icon>
        </button>
      </td>
    </ng-container>
    <!-- Header row -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <!-- D√≤ng comment ch√≠nh -->
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    <!-- D√≤ng ph·∫£n h·ªìi -->
    <tr mat-row *matRowDef="let row; columns: displayedColumns; when: isReplyRow" class="is-reply-row"></tr>
  </table>
  <mat-paginator [length]="totalItems" [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons
    (page)="onPageChange($event)"> <!-- üëà G·∫Øn s·ª± ki·ªán ·ªü ƒë√¢y -->
  </mat-paginator>
  <div *ngIf="dataSource.data.length === 0" class="no-records-message">
    ‚ùå Kh√¥ng t√¨m th·∫•y b√¨nh lu·∫≠n n√†o ph√π h·ª£p v·ªõi t·ª´ kh√≥a "{{ keyword }}"
  </div>
</div>