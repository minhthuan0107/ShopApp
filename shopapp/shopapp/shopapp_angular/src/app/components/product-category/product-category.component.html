<div class="container">
    <div *ngIf="loading" class="loading-overlay">
        <div class="spinner">
            <div class="loading-spinner"></div>
            <p class="loading-text">ƒêang t·∫£i s·∫£n ph·∫©m, xin ch·ªù trong gi√¢y l√°t...</p>
        </div>
    </div>
    <div *ngIf="!loading">
        <div class="intro-section">
            <h2>DANH M·ª§C {{categoryName}}</h2>
            <!-- Th√™m ph·∫ßn s·∫Øp x·∫øp v√† l·ªçc gi√° -->
        </div>
        <div class="row">
            <!-- C·ªôt l·ªçc s·∫£n ph·∫©m (1 c·ªôt) -->
            <div class="col-lg-3 col-md-4 col-12">
                <div class="filter-container">
                    <h3 class="filter-title">
                        <i class="fas fa-filter"></i> B·ªô l·ªçc s·∫£n ph·∫©m
                    </h3>
                    <div class="filter-item">
                        <label>H√£ng s·∫£n ph·∫©m:</label>
                        <div class="brand-grid">
                            <div *ngFor="let brand of brands" class="brand-item"
                                [class.selected]="isBrandSelected(brand)" (click)="toggleBrand(brand)">
                                {{ brand.name }}
                                <i class="fas fa-check check-icon" *ngIf="isBrandSelected(brand)"></i>
                            </div>
                        </div>
                    </div>

                    <div class="filter-item">
                        <label for="sortPrice">S·∫Øp x·∫øp theo gi√°:</label>
                        <select id="sortPrice" (change)="onSortChange($event)" [(ngModel)]="sortBy">
                            <option value="" disabled>-- Ch·ªçn s·∫Øp x·∫øp --</option>
                            <option value="price,asc">Th·∫•p ƒë·∫øn Cao</option>
                            <option value="price,desc">Cao ƒë·∫øn Th·∫•p</option>
                        </select>
                    </div>

                    <div class="filter-item price-range">
                        <label for="priceRange">Ho·∫∑c nh·∫≠p kho·∫£ng gi√° ph√π h·ª£p v·ªõi b·∫°n:</label>
                        <div class="price-inputs">
                            <input type="text" id="minPrice" [value]="minPriceDisplay" (input)="onMinPriceInput($event)"
                                (blur)="onMinPriceBlur($event)" placeholder="Nh·∫≠p gi√° t·ªëi thi·ªÉu">
                            <span class="separator">~</span>
                            <input type="text" id="maxPrice" [value]="maxPriceDisplay" (input)="onMaxPriceInput($event)"
                                (blur)="onMaxPriceBlur($event)" placeholder="Nh·∫≠p gi√° t·ªëi ƒëa">
                        </div>
                    </div>
                </div>
            </div>

            <!-- C·ªôt danh s√°ch s·∫£n ph·∫©m (3 c·ªôt) -->
            <div class="col-lg-9 col-md-8 col-12">
                <!-- N·∫øu c√≥ s·∫£n ph·∫©m -->
                <div class="row" *ngIf="products.length > 0; else noProductsTemplate">
                    <div class="col-lg-4 col-md-6 col-12 mb-4" *ngFor="let product of products">
                        <div class="product-item">
                            <img [src]="product.url_image" alt="Product Image" class="product-image img-fluid">
                            <h3 class="product-name">{{ product.name }}</h3>
                            <p class="product-description">{{ product.description }}</p>
                            <p class="product-warranty">B·∫£o h√†nh: 12 th√°ng</p>
                            <p class="product-price">Gi√°: {{ product.price | number: '1.0-0' }}ƒë</p>
                            <div class="product-rating">
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star-half-alt"></i>
                            </div>
                            <div class="product-actions">
                                <button class="btn btn-primary me-4" title="Th√™m v√†o gi·ªè h√†ng">
                                    <i class="fas fa-cart-plus"></i>
                                </button>
                                <button class="btn btn-success me-4" title="Mua ngay">
                                    <i class="fas fa-shopping-basket"></i>
                                </button>
                                <button class="btn btn-danger" title="Y√™u th√≠ch">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- N·∫øu kh√¥ng c√≥ s·∫£n ph·∫©m -->
                <ng-template #noProductsTemplate>
                    <div class="mt-4 mb-4">
                        <p class="text-danger fs-5 ml-100px">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m ph√π h·ª£p v·ªõi b·∫°n.</p>
                    </div>
                </ng-template>
            </div>

        </div>
        <div class="pagination-controls" *ngIf="products.length > 0">
            <button (click)="onPageChange(1)" [disabled]="isFirstPage()" class="btn-pagination btn-first">‚èÆ</button>
            <button (click)="onPageChange(currentPage - 1)" [disabled]="isFirstPage()"
                class="btn-pagination btn-prev">‚¨Ö</button>
            <div class="page-info">
                <span class="page-number">üìÑ {{ currentPage }} / {{ totalPages}}</span>
            </div>
            <button (click)="onPageChange(currentPage + 1)" [disabled]="isLastPage()"
                class="btn-pagination btn-next">‚û°</button>
            <button (click)="onPageChange(totalPages)" [disabled]="isLastPage()"
                class="btn-pagination btn-last">‚è≠</button>
        </div>
    </div>
</div>